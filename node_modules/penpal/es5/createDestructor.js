"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _default = (localName, log) => {
  const callbacks = [];
  let destroyed = false;
  return {
    destroy(error) {
      if (!destroyed) {
        destroyed = true;
        log(`${localName}: Destroying connection`);
        callbacks.forEach(callback => {
          callback(error);
        });
      }
    },

    onDestroy(callback) {
      destroyed ? callback() : callbacks.push(callback);
    }

  };
};

exports.default = _default;